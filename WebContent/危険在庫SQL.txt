select 商品マスタ.商品ID,商品名,カテゴリ名,仕入基準単価,販売単価,安全在庫数,sum(在庫数) as 在庫数合計
from 商品マスタ inner join 在庫
on 商品マスタ.商品ID = 在庫.商品ID
inner join カテゴリマスタ
on 商品マスタ.カテゴリID = カテゴリマスタ.カテゴリID
where 削除フラグ = '0'
group by 商品マスタ.商品ID,商品名,カテゴリ名,仕入基準単価,販売単価,安全在庫数
having sum(在庫数) < 安全在庫数